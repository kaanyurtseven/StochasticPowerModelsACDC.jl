function mpc = case39_acdc
%CASE39 Power flow data for 39 bus New England system.
%   Please see CASEFORMAT for details on the case file format.
%
%   Data taken from [1] with the following modifications/additions:
%
%       - renumbered gen buses consecutively (as in [2] and [4])
%       - added Pmin = 0 for all gens
%       - added Qmin, Qmax for gens at 31 & 39 (copied from gen at 35)
%       - added Vg based on V in bus data (missing for bus 39)
%       - added Vg, Pg, Pd, Qd at bus 39 from [2] (same in [4])
%       - added Pmax at bus 39: Pmax = Pg + 100
%       - added line flow limits and area data from [4]
%       - added voltage limits, Vmax = 1.06, Vmin = 0.94
%       - added identical quadratic generator costs
%       - increased Pmax for gen at bus 34 from 308 to 508
%         (assumed typo in [1], makes initial solved case feasible)
%       - re-solved power flow
%
%   Notes:
%       - Bus 39, its generator and 2 connecting lines were added
%         (by authors of [1]) to represent the interconnection with
%         the rest of the eastern interconnect, and did not include
%         Vg, Pg, Qg, Pd, Qd, Pmin, Pmax, Qmin or Qmax.
%       - As the swing bus, bus 31 did not include and Q limits.
%       - The voltages, etc in [1] appear to be quite close to the
%         power flow solution of the case before adding bus 39 with
%         it's generator and connecting branches, though the solution
%         is not exact.
%       - Explicit voltage setpoints for gen buses are not given, so
%         they are taken from the bus data, however this results in two
%         binding Q limits at buses 34 & 37, so the corresponding
%         voltages have probably deviated from their original setpoints.
%       - The generator locations and types are as follows:
%           1   30      hydro
%           2   31      nuke01
%           3   32      nuke02
%           4   33      fossil02
%           5   34      fossil01
%           6   35      nuke03
%           7   36      fossil04
%           8   37      nuke04
%           9   38      nuke05
%           10  39      interconnection to rest of US/Canada
%
%   This is a solved power flow case, but it includes the following
%   violations:
%       - Pmax violated at bus 31: Pg = 677.87, Pmax = 646
%       - Qmin violated at bus 37: Qg = -1.37,  Qmin = 0
%
%   References:
%   [1] G. W. Bills, et.al., "On-Line Stability Analysis Study"
%       RP90-1 Report for the Edison Electric Institute, October 12, 1970,
%       pp. 1-20 - 1-35.
%       prepared by E. M. Gulachenski - New England Electric System
%                   J. M. Undrill     - General Electric Co.
%       "generally representative of the New England 345 KV system, but is
%        not an exact or complete model of any past, present or projected
%        configuration of the actual New England 345 KV system.
%   [2] M. A. Pai, Energy Function Analysis for Power System Stability,
%       Kluwer Academic Publishers, Boston, 1989.
%       (references [3] as source of data)
%   [3] Athay, T.; Podmore, R.; Virmani, S., "A Practical Method for the
%       Direct Analysis of Transient Stability," IEEE Transactions on Power
%       Apparatus and Systems , vol.PAS-98, no.2, pp.573-584, March 1979.
%       URL: http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=4113518&isnumber=4113486
%       (references [1] as source of data)
%   [4] Data included with TC Calculator at http://www.pserc.cornell.edu/tcc/
%       for 39-bus system.

%   MATPOWER
%   $Id: case39.m 1559 2010-03-10 18:08:32Z ray $

%% MATPOWER Case Format : Version 2
mpc.version = '2';

%%-----  Power Flow Data  -----%%
%% system MVA base
mpc.baseMVA = 100;

%% bus data
%	bus_i	type	Pd	Qd	Gs	Bs	area	Vm	Va	baseKV	zone	Vmax	Vmin
mpc.bus = [1	1	97.6000000000000	44.2000000000000	0	0	2	1	-13.5366020000000	345	1	1.06000000000000	0.940000000000000
2	1	0	0	0	0	2	1	-9.78526660000000	345	1	1.06000000000000	0.940000000000000
3	1	322	2.40000000000000	0	0	2	1	-12.2763840000000	345	1	1.06000000000000	0.940000000000000
4	1	500	184	0	0	1	1	-12.6267340000000	345	1	1.06000000000000	0.940000000000000
5	1	0	0	0	0	1	1	-11.1923390000000	345	1	1.06000000000000	0.940000000000000
6	1	0	0	0	0	1	1	-10.4083300000000	345	1	1.06000000000000	0.940000000000000
7	1	233.800000000000	84	0	0	1	1	-12.7556260000000	345	1	1.06000000000000	0.940000000000000
8	1	522	176.600000000000	0	0	1	1	-13.3358440000000	345	1	1.06000000000000	0.940000000000000
9	1	6.50000000000000	-66.6000000000000	0	0	1	1	-14.1784420000000	345	1	1.06000000000000	0.940000000000000
10	1	0	0	0	0	1	1	-8.17087500000000	345	1	1.06000000000000	0.940000000000000
11	1	0	0	0	0	1	1	-8.93696630000000	345	1	1.06000000000000	0.940000000000000
12	1	8.53000000000000	88	0	0	1	1	-8.99882360000000	345	1	1.06000000000000	0.940000000000000
13	1	0	0	0	0	1	1	-8.92992720000000	345	1	1.06000000000000	0.940000000000000
14	1	0	0	0	0	1	1	-10.7152950000000	345	1	1.06000000000000	0.940000000000000
15	1	320	153	0	0	3	1	-11.3453990000000	345	1	1.06000000000000	0.940000000000000
16	1	329	32.3000000000000	0	0	3	1	-10.0333480000000	345	1	1.06000000000000	0.940000000000000
17	1	0	0	0	0	2	1	-11.1164360000000	345	1	1.06000000000000	0.940000000000000
18	1	158	30	0	0	2	1	-11.9861680000000	345	1	1.06000000000000	0.940000000000000
19	1	0	0	0	0	3	1	-5.41007290000000	345	1	1.06000000000000	0.940000000000000
20	1	680	103	0	0	3	1	-6.82117830000000	345	1	1.06000000000000	0.940000000000000
21	1	274	115	0	0	3	1	-7.62874610000000	345	1	1.06000000000000	0.940000000000000
22	1	0	0	0	0	3	1	-3.18311990000000	345	1	1.06000000000000	0.940000000000000
23	1	247.500000000000	84.6000000000000	0	0	3	1	-3.38127630000000	345	1	1.06000000000000	0.940000000000000
24	1	308.600000000000	-92.2000000000000	0	0	3	1	-9.91375850000000	345	1	1.06000000000000	0.940000000000000
25	1	224	47.2000000000000	0	0	2	1	-8.36923540000000	345	1	1.06000000000000	0.940000000000000
26	1	139	17	0	0	2	1	-9.43876960000000	345	1	1.06000000000000	0.940000000000000
27	1	281	75.5000000000000	0	0	2	1	-11.3621520000000	345	1	1.06000000000000	0.940000000000000
28	1	206	27.6000000000000	0	0	3	1	-5.92835920000000	345	1	1.06000000000000	0.940000000000000
29	1	283.500000000000	26.9000000000000	0	0	3	1	-3.16987410000000	345	1	1.06000000000000	0.940000000000000
30	2	0	0	0	0	2	1	-7.37047460000000	345	1	1.06000000000000	0.940000000000000
31	3	9.20000000000000	4.60000000000000	0	0	1	1	0	345	1	1.06000000000000	0.940000000000000
32	2	0	0	0	0	1	1	-0.188437400000000	345	1	1.06000000000000	0.940000000000000
33	2	0	0	0	0	3	1	-0.193174450000000	345	1	1.06000000000000	0.940000000000000
34	2	0	0	0	0	3	1	-1.63111900000000	345	1	1.06000000000000	0.940000000000000
35	2	0	0	0	0	3	1	1.77650690000000	345	1	1.06000000000000	0.940000000000000
36	2	0	0	0	0	3	1	4.46843740000000	345	1	1.06000000000000	0.940000000000000
37	2	0	0	0	0	2	1	-1.58289880000000	345	1	1.06000000000000	0.940000000000000
38	2	0	0	0	0	3	1	3.89281770000000	345	1	1.06000000000000	0.940000000000000
39	2	1104	250	0	0	1	1	-14.5352560000000	345	1	1.06000000000000	0.940000000000000];

%% generator data
%	bus	Pg	Qg	Qmax	Qmin	Vg	mBase	status	Pmax	Pmin	Pc1	Pc2	Qc1min	Qc1max	Qc2min	Qc2max	ramp_agc	ramp_10	ramp_30	ramp_q	apf
mpc.gen = [30	250	161.762000000000	400	140	1	100	1	1040	0	0	0	0	0	0	0	0	0	0	0	0
31	677.871000000000	221.574000000000	300	-100	1	100	1	646	0	0	0	0	0	0	0	0	0	0	0	0
32	650	206.965000000000	300	150	1	100	1	725	0	0	0	0	0	0	0	0	0	0	0	0
33	632	108.293000000000	250	0	1	100	1	652	0	0	0	0	0	0	0	0	0	0	0	0
34	508	166.688000000000	167	0	1	100	1	508	0	0	0	0	0	0	0	0	0	0	0	0
35	650	210.661000000000	300	-100	1	100	1	687	0	0	0	0	0	0	0	0	0	0	0	0
36	560	100.165000000000	240	0	1	100	1	580	0	0	0	0	0	0	0	0	0	0	0	0
37	540	-1.36945000000000	250	0	1	100	1	564	0	0	0	0	0	0	0	0	0	0	0	0
38	830	21.7327000000000	300	-150	1	100	1	865	0	0	0	0	0	0	0	0	0	0	0	0
39	1000	78.4674000000000	300	-100	1	100	1	1100	0	0	0	0	0	0	0	0	0	0	0	0];

%% branch data
%	fbus	tbus	r	x	b	rateA	rateB	rateC	ratio	angle	status	angmin	angmax
mpc.branch = [
	1	2	0.0035	0.0411	0.6987	600	600	600	0	0	1	-360	360;
	1	39	0.001	0.025	0.75	1000	1000	1000	0	0	1	-360	360;
	2	3	0.0013	0.0151	0.2572	500	500	500	0	0	1	-360	360;
	2	25	0.007	0.0086	0.146	500	500	500	0	0	1	-360	360;
	2	30	0	0.0181	0	900	900	2500	1.025	0	1	-360	360;
	3	4	0.0013	0.0213	0.2214	500	500	500	0	0	1	-360	360;
	3	18	0.0011	0.0133	0.2138	500	500	500	0	0	1	-360	360;
	4	5	0.0008	0.0128	0.1342	600	600	600	0	0	1	-360	360;
	4	14	0.0008	0.0129	0.1382	500	500	500	0	0	1	-360	360;
	5	6	0.0002	0.0026	0.0434	1200	1200	1200	0	0	1	-360	360;
	5	8	0.0008	0.0112	0.1476	900	900	900	0	0	1	-360	360;
	6	7	0.0006	0.0092	0.113	900	900	900	0	0	1	-360	360;
	6	11	0.0007	0.0082	0.1389	480	480	480	0	0	1	-360	360;
	6	31	0	0.025	0	1800	1800	1800	1.07	0	1	-360	360;
	7	8	0.0004	0.0046	0.078	900	900	900	0	0	1	-360	360;
	8	9	0.0023	0.0363	0.3804	900	900	900	0	0	1	-360	360;
	9	39	0.001	0.025	1.2	900	900	900	0	0	1	-360	360;
	10	11	0.0004	0.0043	0.0729	600	600	600	0	0	1	-360	360;
	10	13	0.0004	0.0043	0.0729	600	600	600	0	0	1	-360	360;
	10	32	0	0.02	0	900	900	2500	1.07	0	1	-360	360;
	12	11	0.0016	0.0435	0	500	500	500	1.006	0	1	-360	360;
	12	13	0.0016	0.0435	0	500	500	500	1.006	0	1	-360	360;
	13	14	0.0009	0.0101	0.1723	600	600	600	0	0	1	-360	360;
	14	15	0.0018	0.0217	0.366	600	600	600	0	0	1	-360	360;
	15	16	0.0009	0.0094	0.171	600	600	600	0	0	1	-360	360;
	16	17	0.0007	0.0089	0.1342	600	600	600	0	0	1	-360	360;
	16	19	0.0016	0.0195	0.304	600	600	2500	0	0	1	-360	360;
	16	21	0.0008	0.0135	0.2548	600	600	600	0	0	1	-360	360;
	16	24	0.0003	0.0059	0.068	600	600	600	0	0	1	-360	360;
	17	18	0.0007	0.0082	0.1319	600	600	600	0	0	1	-360	360;
	17	27	0.0013	0.0173	0.3216	600	600	600	0	0	1	-360	360;
	19	20	0.0007	0.0138	0	900	900	2500	1.06	0	1	-360	360;
	19	33	0.0007	0.0142	0	900	900	2500	1.07	0	1	-360	360;
	20	34	0.0009	0.018	0	900	900	2500	1.009	0	1	-360	360;
	21	22	0.0008	0.014	0.2565	900	900	900	0	0	1	-360	360;
	22	23	0.0006	0.0096	0.1846	600	600	600	0	0	1	-360	360;
	22	35	0	0.0143	0	900	900	2500	1.025	0	1	-360	360;
	23	24	0.0022	0.035	0.361	600	600	600	0	0	1	-360	360;
	23	36	0.0005	0.0272	0	900	900	2500	1	0	1	-360	360;
	25	26	0.0032	0.0323	0.531	600	600	600	0	0	1	-360	360;
	25	37	0.0006	0.0232	0	900	900	2500	1.025	0	1	-360	360;
	26	27	0.0014	0.0147	0.2396	600	600	600	0	0	1	-360	360;
	26	28	0.0043	0.0474	0.7802	600	600	600	0	0	1	-360	360;
	26	29	0.0057	0.0625	1.029	600	600	600	0	0	1	-360	360;
	28	29	0.0014	0.0151	0.249	600	600	600	0	0	1	-360	360;
	29	38	0.0008	0.0156	0	1200	1200	2500	1.025	0	1	-360	360;
];

%%-----  OPF Data  -----%%
%% generator cost data
%	1	startup	shutdown	n	x1	y1	...	xn	yn
%	2	startup	shutdown	n	c(n-1)	...	c0
mpc.gencost = [
	2	0	0	3	0.01	0.3	0.2;
	2	0	0	3	0.01	0.3	0.2;
	2	0	0	3	0.01	0.3	0.2;
	2	0	0	3	0.01	0.3	0.2;
	2	0	0	3	0.01	0.3	0.2;
	2	0	0	3	0.01	0.3	0.2;
	2	0	0	3	0.01	0.3	0.2;
	2	0	0	3	0.01	0.3	0.2;
	2	0	0	3	0.01	0.3	0.2;
	2	0	0	3	0.01	0.3	0.2;
];


%% dc grid topology
%colunm_names% dcpoles
mpc.dcpol=2;
% numbers of poles (1=monopolar grid, 2=bipolar grid)
%% bus data
%column_names%   busdc_i grid    Pdc     Vdc     basekVdc    Vdcmax  Vdcmin  Cdc
mpc.busdc = [
    1              1       0       1       345         1.1     0.9     0;
    2              1       0       1       345         1.1     0.9     0;
	3              1       0       1       345         1.1     0.9     0;
	4              1       0       1       345         1.1     0.9     0;
	5              1       0       1       345         1.1     0.9     0;
	6              1       0       1       345         1.1     0.9     0;
    7              1       0       1       345         1.1     0.9     0;
    8              1       0       1       345         1.1     0.9     0;
    9              1       0       1       345         1.1     0.9     0;
    10             1       0       1       345         1.1     0.9     0;
];

% %% converters
%column_names%   busdc_i busac_i type_dc type_ac P_g   Q_g   islcc Vtar    rtf xtf  transformer tm   bf filter    rc      xc  reactor   basekVac    Vmmax   Vmmin   Imax    status   LossA LossB  LossCrec LossCinv  droop      Pdcset    Vdcset  dVdcset Pacmax Pacmin Qacmax Qacmin
mpc.convdc = [
    1       2   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
    2       9   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
    3      10   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
    4      18   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
    5      26   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
    6      29   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
    7      24   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
    8      14   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
    9      23   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
   10      13   1       1       -60    -40    0 1     0.01  0.01 0 1 0.01 0 0.01   0.01 0  345         1.1     0.9     1.1     1       1.1033 0.887  2.885    2.885      0.0050    -58.6274   1.0079   0 100 -100 100 -100;
    ];

%% branches
%column_names%   fbusdc  tbusdc  r      l        c   rateA   rateB   rateC   status
mpc.branchdc = [
    1       2       0.01   0   0    100     100     100     1;
    2       3       0.01   0   0    100     100     100     1;
    1       4       0.01   0   0    100     100     100     1;
    2       4       0.01   0   0    100     100     100     1;
    2       4       0.01   0   0    100     100     100     1;
    1       5       0.01   0   0    100     100     100     1;
    5       6       0.01   0   0    100     100     100     1;
    5       7       0.01   0   0    100     100     100     1;
    7       4       0.01   0   0    100     100     100     1;
    4       8       0.01   0   0    100     100     100     1;
    8       9       0.01   0   0    100     100     100     1;
    8      10       0.01   0   0    100     100     100     1;
 ];


% adds current ratings to branch matrix
%column_names%	c_rating_a
mpc.branch_currents = [
600;1000;500;500;900;500;500;600;500;1200;900;900;480;1800;900;900;900;600;600;900;500;500;600;600;600;600;600;600;600;600;600;900;900;900;900;600;900;600;900;600;900;600;600;600;600;1200;    
];